<body *ngIf="retrospective">
<div class="foreground">
  <div class="scrollable">
    <div class="locked">
      <br>
        <div class="row title-background">
          <h1 matTooltip="{{retrospective.description}}">{{retrospective.title}}</h1>
          <img class="icon"
            id="icon_wipe"
            src="../../../assets/images/broom.png"
            (click)="cleanRetroBoardDialog()" />
        </div>
      <br>
    </div>

    <div class="board_area">
      <div class="example-container" *ngFor="let column of retrospective.retroColumns">
        <div class="board-title-holder">
          <h2 class="testtitle" *ngIf="!hasEnabledColumnTitleEditing(column)">{{column.title}}</h2>

          <div class="icon_menu">
            <img class="icon" id="icon_menu" src="../../../assets/images/icon_dot_menu.png" [matMenuTriggerFor]="menu">
            <mat-menu #menu="matMenu">
              <button mat-menu-item
                      class="dropdownitem"
                      (click)="emptyColumn(column)">
                {{dict.EMPTY_COLUMN_BTN}}
              </button>
              <button mat-menu-item
                      class="dropdownitem"
                      (click)="deleteColumnDialog(column)">
                {{dict.DELETE_COLUMN_BTN}}
              </button>
              <button mat-menu-item
                      class="dropdownitem"
                      (click)="enableColumnTitleEditing(true, column)">
                {{dict.EDIT_COLUMN_BTN}}
              </button>
            </mat-menu>
          </div>
        </div>

        <div class="box-content" *ngIf="hasEnabledColumnTitleEditing(column)">
          <input type="text" #newtitle value="{{column.title}}">
          <br>
          <button class="TLbtn btn-small btn-color-primary editTitleBtn" (click)="updateColumnTitle(column, newtitle.value)">Aanpassen</button>
        </div>

        <div cdkDropList
             #element="cdkDropList"
             [attr.id]="column.title"
             [cdkDropListData]="column.retroCards"
             [cdkDropListConnectedTo]="getColumnNames(element)"
             class="example-list"
             (cdkDropListDropped)="drop($event, column.id)">
          <div class="example-box" *ngFor="let item of column.retroCards" cdkDrag>
            <div class="box-content" *ngIf="!hasEnabledContentEditing(item)">
              {{item.content}}
            </div>
            <div class="box-content" *ngIf="hasEnabledContentEditing(item)">
              <textarea type="text" class="editContentInput" #content value="{{item.content}}"></textarea>
              <button class="TLbtn btn-small btn-color-primary" (click)="updateContent(item, content.value)">Aanpassen
              </button>
            </div>

            <div class="icons">
              <img class="icon" id="icon_edit" src="../../../assets/images/icon_edit.png"
                   (click)="enableContentEditing(true, item)" alt=""/>
              <img class="icon" id="icon_delete" src="../../../assets/images/icon_delete.png" (click)="deleteCard(item)"
                   alt=""/>
            </div>
          </div>
        </div>

        <div class="example-container-toaddcard">
          <h6 (click)="enableEditing(true, column)" *ngIf="!hasEnabledEditing(column)">+ {{dict.CREATE_NEW_CARD_BTN}}</h6>
          <div class="animated-item" *ngIf="hasEnabledEditing(column)">
            <form [formGroup]="cardGroup">
              <div>
                <mat-form-field [formGroup]="cardGroup" class="inputfield">
                  <label class="inputfield">
                    <input class="inputfield" matInput #card placeholder="{{dict.FILL_IN_DESC_FORM}}"
                           formControlName="content" value="">
                  </label>
                </mat-form-field>
              </div>
              <div>
                <button [disabled]="!cardGroup.valid" mat-button (click)="enableEditing(false, column); addCard(column); openSnackBar(dict.SNACKBAR_SUCCESS_ADD, 'Ok')"
                        class="TLbtn btn-small btn-color-primary">
                  {{dict.ADD_BTN}}
                </button>
                <button mat-button (click)="enableEditing(false, column);"
                        class="TLbtn btn-small btn-color-secondary btn-margin-left">
                  {{dict.CANCEL_BTN}}
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="example-container-toadd">
        <h4 class="clickable_element" (click)="enable=true">+ {{dict.CREATE_NEW_COLUMN_BTN}}</h4>
        <div class="animated-item" *ngIf="enable">
          <form [formGroup]="listGroup">
            <div>
              <mat-form-field [formGroup]="listGroup" class="inputfield">
                <input matInput #column placeholder="{{dict.FILL_IN_TITLE_FORM}}" class="inputfield"
                       formControlName="title" value="">
              </mat-form-field>
            </div>
            <div>
              <button [disabled]="!listGroup.valid" mat-button (click)="enable=false; addColumn(column.value); openSnackBar(dict.SNACKBAR_SUCCESS_ADD, 'Ok')"
                      class="TLbtn btn-small btn-color-primary click_should_disable">
                {{dict.ADD_BTN}}
              </button>
              <button mat-button (click)="enable=false"
                      class="TLbtn btn-small btn-color-secondary clickable_element_closed btn-margin-left">
                {{dict.CANCEL_BTN}}
              </button>
            </div>
          </form>
        </div>
      </div>

    </div>
  </div>
</div>
</body>

